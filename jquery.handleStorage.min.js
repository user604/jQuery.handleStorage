/* https://www.github.com/jas-/jQuery.handleStorage */
(function(a){a.fn.handleStorage=function(e){var m={appID:"jQuery.handleStorage",storage:"localStorage",interval:5000,aes:false,uuid:"",form:"",data:{},callback:function(){},preCallback:function(){},errCallback:function(){}};var z={init:function(B){var A=a.extend({},m,B);A.form=a(this).attr("id");if(o(A)){A.data[A.appID]=(f(A))?f(A):{};var C=d(A);if((typeof C==="object")&&(j(C)>0)){w(A,C)}((A.preCallback)&&(a.isFunction(A.preCallback)))?A.preCallback(a(this)):false;a("#"+A.form).delegate("input, input:radio:selected, input:checkbox:checked, select, textarea","change keyup blur submit",function(){h(A)});setInterval(function(){h(A)},A.interval);return true}else{return false}}};var j=function(A){var B=0;a.each(A,function(D,C){if(A.hasOwnProperty(D)){B++}});return B};var b=function(A){var B=/local|session/.test(A)?1024*1025*5:1024*4;if(B-unescape(encodeURIComponent(JSON.stringify(A))).length<=0){console.log("Maximum quota has been met using "+A);return false}return true};var t=function(D,C,B){var A=false;D=(c(D))?D:"cookie";if(b(D)){switch(D){case"localStorage":A=q(C,B);break;case"sessionStorage":A=k(C,B);break;case"cookie":A=x(C,B);break;default:A=q(C,B);break}}return A};var p=function(C,B){var A=false;C=(c(C))?C:"cookie";switch(C){case"localStorage":A=l(B);break;case"sessionStorage":A=i(B);break;case"cookie":A=v(B);break;default:A=l(B);break}return A};var q=function(B,A){return(localStorage.setItem(B,A))?false:true};var k=function(B,A){return(sessionStorage.setItem(B,A))?false:true};var x=function(B,A){if(typeof a.cookie==="function"){return(a.cookie(B,A,{expires:7}))?true:false}else{return false}};var l=function(A){return(localStorage.getItem(A))?localStorage.getItem(A):false};var i=function(A){return(sessionStorage.getItem(A))?sessionStorage.getItem(A):false};var v=function(A){if(typeof a.cookie==="function"){return(a.cookie(A))?a.cookie(A):false}else{return false}};var f=function(A){return(p(A.storage,A.appID))?JSON.parse(p(A.storage,A.appID)):false};var d=function(C){var B={},A;if(typeof C.data[C.appID][C.form]==="object"){a.each(a("#"+C.form+" > :input"),function(E,D){if(typeof C.data[C.appID][C.form][D.name]=="object"){B[D.name]=[];a.each(C.data[C.appID][C.form][D.name],function(G,F){B[D.name][G]=((C.aes)&&(C.data[C.appID][C.form]["uuid"])&&(A!==false))?GibberishAES.dec(F,g(C.data[C.appID][C.form]["uuid"])):F})}else{if((r(D.name)!==false)&&(r(C.data[C.appID][C.form][D.name])!==false)){B[D.name]=((C.aes)&&(C.data[C.appID][C.form]["uuid"])&&(A!==false))?GibberishAES.dec(C.data[C.appID][C.form][D.name],g(C.data[C.appID][C.form]["uuid"])):C.data[C.appID][C.form][D.name]}}})}return B};var w=function(B,A){if(j(A)>0){a.each(A,function(D,C){if((a("#"+B.form+" > input[name="+D+"]").attr("name")===D)||(a("#"+B.form+" > select[name="+D+"]").attr("name")===D)||(a("#"+B.form+" > textarea[name="+D+"]").attr("name")===D)&&(r(C)!==false)){if((/checkbox|radio/.test(a("#"+B.form+" > input[name="+D+"]").attr("type")))&&(a("#"+B.form+" > input[name="+D+"]").attr("value")==C)){a("#"+B.form+" > input[name="+D+"]").attr("checked",true)}else{a("#"+B.form+" > input[name="+D+"], #"+B.form+" > select[name="+D+"], #"+B.form+" > textarea[name="+D+"]").val(C)}}})}};var h=function(B){var A={};A[B.form]={};A[B.form]["uuid"]=((B.aes)&&(!B.uuid))?y(B):B.uuid;a.each(a("#"+B.form+" > :input"),function(D,C){if((r(C.value)!==false)&&(r(C.name)!==false)){if(/checkbox|radio/.test(C.type)){A[B.form][C.name]=s(B,C,C.type,A[B.form]["uuid"])}else{A[B.form][C.name]=((B.aes)&&(A[B.form]["uuid"]))?GibberishAES.enc(C.value,g(A[B.form]["uuid"])):C.value}}});B.data[B.appID]=(j(B.data[B.appID])>0)?a.extend({},B.data[B.appID],A):A;if(t(B.storage,B.appID,JSON.stringify(B.data[B.appID]))){((B.callback)&&(a.isFunction(B.callback)))?B.callback.call(a(this)):false}else{((B.errCallback)&&(a.isFunction(B.errCallback)))?B.errCallback.call(a(this)):false}};var s=function(D,C,B,A){return a("#"+D.form+" > input:"+B+":checked").map(function(){return((D.aes)&&(A))?GibberishAES.enc(this.value,g(A)):this.value}).get()};var r=function(A){if(A){return((A===false)||(A.length===0)||(!A)||(A===null)||(A==="")||(typeof A==="undefined"))?false:true}else{return false}};var c=function(A){try{return((A in window)&&(window[A]))?true:false}catch(B){console.log("The "+A+" storage mechanism does not exist, please upgrade your browser");return false}};var o=function(B){var A=true;if(B.aes){if(!a.isFunction(GibberishAES.enc)){console.log("AES use specified but required libraries not available. Please include the Gibberish-AES libs...");A=false}}if(B.storage==="cookie"){if(!a.isFunction(a.cookie)){console.log("Cookie use specified but required libraries not available. Please include the jQuery cookie plugin...");A=false}}return A};var u=function(A){var F="0123456789abcdef".split("");var D=[],C=Math.random,E;D[8]=D[13]=D[18]=D[23]="-";D[14]="4";for(var B=0;B<36;B++){if(!D[B]){E=0|C()*16;D[B]=F[(B==19)?(E&3)|8:E&15]}}return(A!==null)?D.join("").replace(/-/g,"").split("",A).join(""):D.join("")};var y=function(B){if(B.aes){var A=(f(B))?f(B):{};A[B.form]=(A[B.form])?A[B.form]:{};var C=(r(A[B.form]["uuid"]))?A[B.form]["uuid"]:u(null);return C}return false};var g=function(A){return(A)?encodeURI(A.replace(/-/gi,"").substring(16,Math.ceil(16*A.length)%A.length)):false};var n=function(A){a.each(A,function(B,C){if(typeof C==="object"){n(C)}else{console.log(B+" => "+C)}})};if(z[e]){return z[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if((typeof e==="object")||(!e)){return z.init.apply(this,arguments)}else{a.error("Method "+e+" does not exist on "+opts.name)}}}})(jQuery);